import{d as k,u as N,r as i,o as C,_ as V,c as m,a as t,b as h,e as v,t as b,w as y,v as w,f,g as M,h as A,i as p}from"./index-BHfDbzrd.js";import{u as P}from"./users-msOP0oqz.js";import{S as j}from"./SettingsNavigationMenu-CsWxikFR.js";const z=k({name:"SettingsPage",components:{SettingsNavigationMenu:j},setup(){var x,c;const s=N(),e=P(),l=i(s.getUser),g=i(s.getUserRole),u=i(((x=l.value)==null?void 0:x.username)||""),d=i(((c=l.value)==null?void 0:c.email)||""),a=i(!1),n=i(!1),r=()=>{a.value=!a.value},o=()=>{n.value=!n.value},E=async()=>{l.value&&(await e.updateUser(l.value.id,{...l.value,username:u.value}),l.value.username=u.value,r())},U=async()=>{l.value&&(await e.updateUser(l.value.id,{...l.value,email:d.value}),l.value.email=d.value,o())},S=async()=>{l.value&&(await e.deleteUser(l.value.id),s.logout())};return C(async()=>{l.value||(await s.fetchUser(),l.value=s.getUser)}),{user:l,username:u,userRole:g,email:d,isEditingUsername:a,isEditingEmail:n,toggleUsernameEdit:r,saveUsername:E,toggleEmailEdit:o,saveEmail:U,deleteAccount:S}}}),B={class:"mx-4 min-h-screen max-w-screen-xl sm:mx-8 xl:mx-auto"},$={class:"grid grid-cols-8 pt-3 sm:grid-cols-10"},R={class:"col-span-8 overflow-hidden rounded-xl sm:bg-gray-50 sm:px-8 sm:shadow"},D={class:"flex flex-col sm:flex-row sm:items-center sm:justify-between"},T={class:"text-gray-600"},H={key:0,class:"mt-4 flex flex-col sm:flex-row sm:items-center sm:justify-between"},I={class:"relative flex overflow-hidden rounded-md border-2 transition focus-within:border-blue-600"},q={class:"flex flex-col sm:flex-row sm:items-center sm:justify-between"},F={class:"text-gray-600"},G={key:1,class:"mt-4 flex flex-col sm:flex-row sm:items-center sm:justify-between"},J={class:"relative flex overflow-hidden rounded-md border-2 transition focus-within:border-blue-600"},K={key:2,class:"mb-10"};function L(s,e,l,g,u,d){var n,r;const a=A("SettingsNavigationMenu");return p(),m("div",B,[e[17]||(e[17]=t("h1",{class:"border-b py-6 text-4xl font-semibold"},"Paramètres",-1)),t("div",$,[h(a),t("div",R,[e[11]||(e[11]=t("div",{class:"pt-4"},[t("h1",{class:"py-2 text-2xl font-semibold"},"Paramètres du compte")],-1)),e[12]||(e[12]=t("hr",{class:"mt-4 mb-8"},null,-1)),e[13]||(e[13]=t("p",{class:"py-2 text-xl font-semibold"},"Nom d'utilisateur",-1)),t("div",D,[t("p",T,[e[7]||(e[7]=v(" Votre nom d'utilisateur est ")),t("strong",null,b((n=s.user)==null?void 0:n.username),1)]),t("button",{class:"inline-flex text-sm font-semibold text-blue-600 underline decoration-2",onClick:e[0]||(e[0]=(...o)=>s.toggleUsernameEdit&&s.toggleUsernameEdit(...o))}," Modifier ")]),s.isEditingUsername?(p(),m("div",H,[t("div",I,[y(t("input",{"onUpdate:modelValue":e[1]||(e[1]=o=>s.username=o),type:"text",class:"w-full flex-shrink appearance-none border-gray-300 bg-white py-2 px-4 text-base text-gray-700 placeholder-gray-400 focus:outline-none",placeholder:"Nouveau nom d'utilisateur"},null,512),[[w,s.username]]),e[8]||(e[8]=v(" /> "))]),t("button",{class:"mt-4 rounded-lg bg-blue-600 px-4 py-2 text-white",onClick:e[2]||(e[2]=(...o)=>s.saveUsername&&s.saveUsername(...o))}," Enregistrer le nom d'utilisateur ")])):f("",!0),e[14]||(e[14]=t("hr",{class:"mt-4 mb-8"},null,-1)),e[15]||(e[15]=t("p",{class:"py-2 text-xl font-semibold"},"Adresse e-mail",-1)),t("div",q,[t("p",F,[e[9]||(e[9]=v(" Votre adresse e-mail est ")),t("strong",null,b((r=s.user)==null?void 0:r.email),1)]),t("button",{class:"inline-flex text-sm font-semibold text-blue-600 underline decoration-2",onClick:e[3]||(e[3]=(...o)=>s.toggleEmailEdit&&s.toggleEmailEdit(...o))}," Modifier ")]),s.isEditingEmail?(p(),m("div",G,[t("div",J,[y(t("input",{"onUpdate:modelValue":e[4]||(e[4]=o=>s.email=o),type:"email",class:"w-full flex-shrink appearance-none border-gray-300 bg-white py-2 px-4 text-base text-gray-700 placeholder-gray-400 focus:outline-none",placeholder:"Nouvelle adresse e-mail"},null,512),[[w,s.email]])]),t("button",{class:"mt-4 rounded-lg bg-blue-600 px-4 py-2 text-white",onClick:e[5]||(e[5]=(...o)=>s.saveEmail&&s.saveEmail(...o))}," Enregistrer l'e-mail ")])):f("",!0),e[16]||(e[16]=t("hr",{class:"mt-4 mb-8"},null,-1)),s.userRole==="Supervisor"?(p(),m("div",K,[e[10]||(e[10]=M('<p class="py-2 text-xl font-semibold">Supprimer le compte</p><p class="inline-flex items-center rounded-full bg-rose-100 px-4 py-1 text-rose-600"><svg xmlns="http://www.w3.org/2000/svg" class="mr-2 h-5 w-5" viewBox="0 0 20 20" fill="currentColor"><path fill-rule="evenodd" d="M8.257 3.099c.765-1.36 2.722-1.36 3.486 0l5.58 9.92c.75 1.334-.213 2.98-1.742 2.98H4.42c-1.53 0-2.493-1.646-1.743-2.98l5.58-9.92zM11 13a1 1 0 11-2 0 1 1 0 012 0zm-1-8a1 1 0 00-1 1v3a1 1 0 002 0V6a1 1 0 00-1-1z" clip-rule="evenodd"></path></svg> Proceed with caution </p><p class="mt-2"> Assurez-vous d&#39;avoir fait une sauvegarde de votre compte. Il n&#39;y a aucun moyen d&#39;accéder à votre compte après cette action. </p>',3)),t("button",{class:"ml-auto text-sm font-semibold text-rose-600 underline decoration-2",onClick:e[6]||(e[6]=(...o)=>s.deleteAccount&&s.deleteAccount(...o))}," Continuer avec la suppression ")])):f("",!0)])])])}const X=V(z,[["render",L]]);export{X as default};
