import{S as I}from"./SettingsNavigationMenu-CsWxikFR.js";import{d as k,T as L,M as z,u as B,r as m,k as p,l as j,h as y,i as f,c as b,f as c,t as U,b as v,m as g,a as t,w as C,v as w,_ as P}from"./index-BHfDbzrd.js";import{u as R}from"./users-msOP0oqz.js";const q=k({name:"UsersList",components:{TableComponent:L,ModalComponent:z},setup(){const e=R(),o=B(),i=m(!1),u=m(!1),r=m({username:"",email:"",role:0}),d=m(null),a=m(null),n=()=>{e.fetchAllUsers()},s=p(()=>e.users),S=p(()=>e.loading),V=p(()=>e.error),$=p(()=>e.pagingParams),N=p(()=>{var l;return((l=e.pagination)==null?void 0:l.total_pages)||0}),h=l=>{l>=1&&e.setPage(l)},E=l=>{r.value={username:l.username,email:l.email,role:l.role},d.value=l.id,i.value=!0},D=()=>{i.value=!1,r.value={username:"",email:"",role:0},d.value=null},F=async()=>{d.value&&(await e.updateUser(d.value,r.value),D(),n())},A=l=>{a.value=l,u.value=!0},M=()=>{u.value=!1,a.value=null},T=async()=>{a.value&&(await e.deleteUser(a.value.id),M(),n())};return j(()=>o.user,n,{immediate:!0}),{users:s,loading:S,error:V,changePage:h,pagingParams:$,totalPages:N,showUpdateModal:i,showDeleteConfirm:u,updateForm:r,openUpdateModal:E,confirmDelete:A,deleteUser:T,closeDeleteConfirm:M,closeUpdateModal:D,updateUser:F}}}),G={class:"p-6"},H={key:0,class:"text-gray-500"},J={key:1,class:"text-red-600"},K={key:2},O={class:"flex justify-end"},Q={class:"flex justify-end mt-4"};function W(e,o,i,u,r,d){const a=y("TableComponent"),n=y("ModalComponent");return f(),b("div",G,[e.loading?(f(),b("div",H,"Loading...")):c("",!0),e.error?(f(),b("div",J,U(e.error),1)):c("",!0),!e.loading&&!e.error?(f(),b("div",K,[v(a,{headers:["Name","Email"],data:e.users,"current-page":e.pagingParams.pageNumber,totalPages:e.totalPages,"items-per-page":e.pagingParams.pageSize,isAuthorized:e.isAuthorized,onEditItem:e.openUpdateModal,onDeleteItem:e.confirmDelete,onChangePage:e.changePage},{"cell-Name":g(({item:s})=>[t("div",null,U(s.username),1)]),"cell-Email":g(({item:s})=>[t("div",null,U(s.email),1)]),"cell-Role":g(({item:s})=>[t("div",null,U(s.role),1)]),_:1},8,["data","current-page","totalPages","items-per-page","isAuthorized","onEditItem","onDeleteItem","onChangePage"]),v(n,{modelValue:e.showUpdateModal,"onUpdate:modelValue":o[5]||(o[5]=s=>e.showUpdateModal=s)},{default:g(()=>[o[9]||(o[9]=t("h2",{class:"text-lg font-semibold mb-4"},"Update User",-1)),o[10]||(o[10]=t("label",{class:"block mb-2"},"Name:",-1)),C(t("input",{type:"text","onUpdate:modelValue":o[0]||(o[0]=s=>e.updateForm.username=s),class:"border border-gray-300 rounded p-2 w-full mb-4"},null,512),[[w,e.updateForm.username]]),o[11]||(o[11]=t("label",{class:"block mb-2"},"Email:",-1)),C(t("input",{type:"email","onUpdate:modelValue":o[1]||(o[1]=s=>e.updateForm.email=s),class:"border border-gray-300 rounded p-2 w-full mb-4"},null,512),[[w,e.updateForm.email]]),o[12]||(o[12]=t("label",{class:"block mb-2"},"Role:",-1)),C(t("input",{type:"text","onUpdate:modelValue":o[2]||(o[2]=s=>e.updateForm.role=s),class:"border border-gray-300 rounded p-2 w-full mb-4"},null,512),[[w,e.updateForm.role]]),t("div",O,[t("button",{class:"px-4 py-2 bg-blue-500 text-white rounded",onClick:o[3]||(o[3]=(...s)=>e.updateUser&&e.updateUser(...s))}," Update "),t("button",{class:"ml-2 px-4 py-2 bg-gray-300 rounded",onClick:o[4]||(o[4]=(...s)=>e.closeUpdateModal&&e.closeUpdateModal(...s))}," Cancel ")])]),_:1},8,["modelValue"]),v(n,{modelValue:e.showDeleteConfirm,"onUpdate:modelValue":o[8]||(o[8]=s=>e.showDeleteConfirm=s)},{default:g(()=>[o[13]||(o[13]=t("h2",{class:"text-lg font-semibold mb-4"},"Confirm Deletion",-1)),o[14]||(o[14]=t("p",null,"Are you sure you want to delete this user?",-1)),t("div",Q,[t("button",{class:"px-4 py-2 bg-red-500 text-white rounded",onClick:o[6]||(o[6]=(...s)=>e.deleteUser&&e.deleteUser(...s))}," Delete "),t("button",{class:"ml-2 px-4 py-2 bg-gray-300 rounded",onClick:o[7]||(o[7]=(...s)=>e.closeDeleteConfirm&&e.closeDeleteConfirm(...s))}," Cancel ")])]),_:1},8,["modelValue"])])):c("",!0)])}const X=P(q,[["render",W]]),Y=k({name:"SettingsDocuments",components:{SettingsNavigationMenu:I,UsersList:X},setup(){return{}}}),Z={class:"mx-4 min-h-screen max-w-screen-xl sm:mx-8 xl:mx-auto"},x={class:"grid grid-cols-8 pt-3 sm:grid-cols-10"},_={class:"col-span-8 overflow-hidden rounded-xl sm:bg-gray-50 sm:px-8 sm:shadow"};function ee(e,o,i,u,r,d){const a=y("SettingsNavigationMenu"),n=y("UsersList");return f(),b("div",Z,[o[0]||(o[0]=t("h1",{class:"border-b py-6 text-4xl font-semibold"},"Employees",-1)),t("div",x,[v(a),t("div",_,[v(n)])])])}const le=P(Y,[["render",ee]]);export{le as default};
